# database-works
Домашнее задание по предмету базы данных
База данных MySQL, сервер AMPPS
После запуска сервера ипользую PHPMyAdmin, происходит коннект к БД, после чего создаю БД по условуию задачи
После создания БД происходит создание таблиц и заполнение их данными

SQL запросы написаны в ветке main в папке src в соответствующих директориях заданиям и с соотвествующими названиями файлов
crateTable.txt - файлы с созданием таблиц для MySQL в SQL запросе PHPMyAdmin и заполнением данных
имя файла = задача + ее номер.
Для проверки SQL скрипта его необходимо скопировать и поместить в SQL запрос PHPMyAdmin с существующими таблицами и данными.

Описание проекта.
В данный проект входило создание баз данных с кодировкой utf8mb4_general_ci с таблицами со связями.
Основной задачей проекта была реализация функционала для четырех баз данных.
Первая база данных "Транспортные средства" подразумевала создание 4-х таблиц с данными и выполнение 2-х задач.
Задачи включали в себя сортировку и вывод данных о транспортных средствах.
Вторая база данных "Автомобильные гонки" подразумевала создание 4-х таблиц с данными и выполнение 5 задач.
Задачи включали в себя сортировку и вывод данных позиции автомобилей с учетом их характеристик и достижений.
Вторая база данных "Бронирование отелей" подразумевала создание 4-х таблиц с данными и выполнение 3-х задач.
Задачи включали в себя вывод информации о бронировании отелей, клиентах, длительности пребыванияи и прочих условий,
а также сортировку, объединение и группировку данных.
Вторая база данных "Структура организации" подразумевала создание 5 таблиц с данными и выполнение 3-х задач.
Задачи включали в себя вывод информации о подчиненных сотрудниках и управляющих с подчиненными, включая методы с RECURSIVE, CONCAT.

Основной целью выполнения домашнего задания является закрепление знаний, приобретенных с теории и лекций на практике.

Пример запуска программы:
1) Запуск AMPPS
2) Переход по ссылке http://localhost:8080/phpmyadmin
3) Авторизация
4) Создание БД в кодировке utf8mb4_general_ci
5) Переход на вкладку SQL
6) Вставка данных по созданию таблиц и заполнению данными с GITHUB по пути src/DB1/createTable.txt
7) Проверка таблиц по наполнению и связей на диаграмме
8) Вставка SQL кода из GITHUB по ссылке https://github.com/Bau6/database-works по пути src/DB1/Task 1.txt
9) Вставка SQL кода из Task 2.txt

Описание решения задач (комментарии пишутся через "--", были исключены):

База данных 1. Транспортные средства

Задача 1. Вывести модель и название авто
Решение:
Объединяем таблицы по модели, фильтруем по мощности, цене и типу, сортируем по мощности в порядке убывания.

Задача 2.
Решение:
Фильтрация автомобилей с выбранными параметрами. Установка типа транспорта Car
Фильтрация мотоциклов аналогично, тип транспорта Motorcycle
Фильтрация велосипедов. Замена на NULL параметров, которых нет. Тип Bicycle
С помощью UNION объединяем
Сортировка по мощности, где NULL в конец.



База данных 2 . Автомобильные гонки

Задача 1.
Решение:
Вычисление средней позиции для авто
Вычисление количества гонок
Группировка по классу
Определение минимальной средней позиции для каждого класса
Объединение (средняя позиция + минимальная)
Сортировка по средней позиции

Задача 2.
Решение:
Вычисление средней позиции для авто
Вычисление количества гонок
Добавление класса и страны
Определение мин средней позиции
Сортировка по имени
LIMIT 1 выбирает только 1 авто

Задача 3.
Решение:
Вычисление средней позиции для авто
Вычисление количества гонок
Добавление страны
Определение мин средней позиции среди классов
Выбор классов с мин средней позицией
Выбор авто с классами мин средней позиции
Сортировка по имени

Задача 4.
Решение:
Вычисление средней позиции для каждого класса
Вычисление кол-ва авто в классе
Условие >= 2 авто
Средняя позиция для каждого авто
Вычисление кол-ва гонок авто
Класс и страна добавление
Сравнение средних позиций авто и класса
Сортировка по классу, по средней позиции

Задача 5.
Решение:
Вычисление средней позиции для авто
Вычисление количества гонок
Добавление класса и страны
average_position > 3.0
Вычисление количества гонок автомобилей класса
Сортировка по кол-ву авто с низкой средней позицией



База данных 3. Бронирование отелей

Задача 1.
Решение:
Разбор запроса:
Объединение таблиц для получения данных
CONCAT для объединения через запятую
Подсчет и выборка данных > 2 бронирований
Сортировка по убыванию

Задача 2.
Решение:
CustomerBookings временная таблица с необходимыми данными
FilteredCustomers фильтрация клиентов > 2 бронирований > 1 отеле и затраты > 500
Сортировка по возрастанию

Задача 3.
Решение:
HotelCategory временная таблица с определением стоимостей "дешевый" "средний" "дорогой"
CustomerPreferences, где уникальниые отели клиента, тип отеля
Сортировка по типу и по ID_customer



База данных 4. Структура организации

Задача 1.
Решение:
Рекурсия EmployeeHierarchy
WHERE e.EmployeeID = 1
Подразумевает выбор Ивана Иванова как управляющего
Добавление всех сотрудников, где ManagerID соответствует сотруднику
Присоединение проектов по отделу, затем задач для сотрудника и группировка CONCAT
Сортировка по имени

Задача 2.
Решение:
Рекурсия EmployeeHierarchy
WHERE e.EmployeeID = 1
Подразумевает выбор Ивана Иванова как управляющего
Рекурсия доя нахождения подчиненных
Выборка полей
CONCAT для объединения через "," 
Фильтрация, группировка и сортировка

Задача 3.
Решение:
Subordinates все менеджеры с подчиненными, добавление рекурсивно
Объединение данных с таблицами
CONCAT для объединения через ","
Фильтр что только с подчиненными
Сортировка по имени
